<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>VibeXXX Pro Membership</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      background: #0f0f0f;
      font-family: 'Inter', sans-serif; /* Changed font to Inter */
      color: white;
      text-align: center;
      padding: 20px;
      display: flex; /* Use flexbox for centering content */
      flex-direction: column;
      align-items: center;
      min-height: 100vh; /* Ensure it takes full viewport height */
      box-sizing: border-box; /* Include padding in element's total width and height */
    }
    h1 {
      margin-top: 20px; /* Adjust top margin */
      margin-bottom: 15px;
      font-size: 2.5em; /* Larger heading */
      color: #ff3366; /* Eye-catching color */
      text-shadow: 0 0 10px rgba(255, 51, 102, 0.5); /* Subtle glow */
    }
    p {
      font-size: 1.1em;
      margin-bottom: 25px;
      color: #ccc;
    }
    .membership-options, .button-group {
      display: flex; /* Use flexbox for buttons */
      flex-wrap: wrap; /* Allow buttons to wrap on smaller screens */
      justify-content: center;
      gap: 15px; /* Space between buttons */
      margin-bottom: 30px;
      width: 100%;
      max-width: 600px; /* Limit width for larger screens */
    }
    button {
      padding: 15px 30px;
      border: none;
      border-radius: 12px; /* More rounded corners */
      font-size: 1.1em; /* Slightly larger font */
      cursor: pointer;
      transition: all 0.3s ease; /* Smooth transitions */
      font-weight: 600; /* Bolder text */
      flex-grow: 1; /* Allow buttons to grow */
      min-width: 180px; /* Minimum width for buttons */
      box-shadow: 0 4px 10px rgba(0,0,0,0.3); /* Subtle shadow */
    }
    .membership-btn {
        background: #333;
        color: white;
        border: 2px solid #555; /* Thicker border */
    }
    .membership-btn:hover {
        background: #444;
        border-color: #ff3366;
        transform: translateY(-3px); /* Lift effect */
        box-shadow: 0 6px 15px rgba(255, 51, 102, 0.3);
    }
    .membership-btn.active {
        background: linear-gradient(to right, #ff1493, #ff416c); /* Gradient for active */
        border-color: #ff3366;
        box-shadow: 0 0 15px rgba(255, 51, 102, 0.7); /* Stronger glow for active */
        transform: translateY(-2px);
    }
    .upi-btn { background: #4caf50; color: white; }
    .paypal-btn { background: #0070ba; color: white; }
    .upi-btn:hover { background: #5cb85c; transform: translateY(-3px); box-shadow: 0 6px 15px rgba(76, 175, 80, 0.3); }
    .paypal-btn:hover { background: #008cdd; transform: translateY(-3px); box-shadow: 0 6px 15px rgba(0, 112, 186, 0.3); }

    .qr-section, .submit-form {
      display: none;
      width: 90%; /* Use percentage for responsiveness */
      max-width: 450px; /* Slightly larger max-width for forms/QR */
      margin: 20px auto;
      background: #1c1c1c;
      padding: 25px; /* More padding */
      border-radius: 20px;
      box-shadow: 0 0 20px rgba(0,0,0,0.5); /* Stronger shadow for depth */
      /* This margin-top was already there in your last working code, keeping it */
      margin-top: 40px; 
    }
    .qr-section img {
      max-width: 70%; /* Slightly smaller QR image for better fit */
      height: auto;
      border-radius: 10px;
      margin-bottom: 20px; /* More margin */
      border: 5px solid #ff3366; /* Border around QR */
      padding: 5px; /* Padding inside border */
      background: white; /* White background for QR */
    }
    .qr-section p {
        font-size: 1.1em;
        color: #ddd;
        margin-top: 10px;
    }
    .qr-section a {
        color: #00ff99; /* Link color */
        text-decoration: none;
        font-weight: 600;
    }
    .qr-section a:hover {
        text-decoration: underline;
    }
    /* --- START OF MINIMAL CSS CHANGES FOR SPACING --- */
    /* Apply margin-bottom to inputs/textareas, and ensure full width */
    input:not([type="file"]), select, textarea { 
      background: #2d2d2d;
      color: #fff;
      border: 1px solid #444;
      margin-bottom: 20px; /* Increased spacing after inputs */
      font-size: 1rem;
      padding: 12px;
      border-radius: 8px;
      width: 100%; /* Ensure inputs take full width */
      box-sizing: border-box; /* Include padding in width */
    }

    /* Styles for labels to ensure proper vertical spacing and alignment */
    label {
      display: block; /* Make labels block-level to apply vertical margins */
      text-align: left; /* Align text to the left */
      margin-top: 20px; /* Space above each label */
      margin-bottom: 5px; /* Small space between label and its input */
      font-size: 1rem; /* Ensure consistent font size */
      color: #ddd; /* Slightly lighter color for labels */
    }

    /* Override for the very first label in the form to prevent excessive top margin */
    #paymentForm label:first-of-type {
        margin-top: 0;
    }

    /* Specific adjustment for file input's margin-bottom */
    input[type="file"] {
      background: #222;
      color: white;
      padding: 10px;
      border: 1px dashed #ff3366;
      cursor: pointer;
      margin-bottom: 20px; /* Ensure spacing after file input */
      width: 100%; /* Full width */
      box-sizing: border-box;
    }

    /* Adjust hint text spacing */
    .hint {
      font-size: 0.9em;
      color: #aaa;
      margin-top: -15px; /* Adjust spacing to be closer to input, but still separate */
      margin-bottom: 25px; /* More space after hint */
      text-align: left;
      padding-left: 5px;
    }
    /* --- END OF MINIMAL CSS CHANGES FOR SPACING --- */

    hr {
        border-color: #ff3366;
        margin: 50px auto; /* More vertical margin */
        width: 60%; /* Wider separator */
        border-top: 2px solid; /* Thicker line */
        opacity: 0.7;
    }

    /* New styles for pricing display */
    .price-display {
        font-size: 1.2em;
        margin-top: 10px;
        color: #00ff99;
        font-weight: bold;
    }
    .currency-note {
        font-size: 0.8em;
        color: #aaa;
        margin-top: 5px;
    }
    /* Responsive adjustments */
    @media (max-width: 600px) {
        h1 {
            font-size: 2em;
        }
        p {
            font-size: 1em;
        }
        .membership-options, .button-group {
            flex-direction: column; /* Stack buttons vertically on small screens */
            gap: 10px;
        }
        button {
            width: 100%; /* Full width buttons */
            min-width: unset;
        }
        .qr-section, .submit-form {
            padding: 20px;
        }
        .qr-section img {
            max-width: 90%;
        }
    }
  </style>
</head>
<body>

  <!-- Removed the <video> element as requested -->

  <h1>ðŸ’Ž Become a Pro Member</h1>
  <p>Choose your membership plan and payment method</p>

  <!-- Membership Plan Selection -->
  <div class="membership-options">
    <button class="membership-btn" data-plan="1_MONTH" data-price-inr="249" data-price-usd="5.99">
        1 Month Membership
        <div class="price-display">â‚¹249 / $5.99</div>
    </button>
    <button class="membership-btn" data-plan="3_MONTH" data-price-inr="599" data-price-usd="14.99">
        3 Month Membership
        <div class="price-display">â‚¹599 / $14.99</div>
    </button>
    <!-- Add more plans if needed -->
  </div>

  <div class="button-group">
    <button class="upi-btn" data-method="upi">Pay with UPI</button>
    <button class="paypal-btn" data-method="paypal">Pay with PayPal</button>
  </div>

  <!-- UPI QR Section -->
  <div id="upi" class="qr-section">
    <img src="https://raw.githubusercontent.com/itsleo4/VibeXXX/main/images/upi.png" alt="UPI QR">
    <p><strong>Pay to:</strong> bharti00077-2@okaxis</p>
    <p class="currency-note">For 1 Month: â‚¹249 | For 3 Months: â‚¹599</p>
  </div>

  <!-- PayPal QR Section -->
  <div id="paypal" class="qr-section">
    <img src="https://raw.githubusercontent.com/itsleo4/VibeXXX/main/images/paypal.png" alt="PayPal QR">
    <p><strong>PayPal:</strong> <a href="https://www.paypal.me/PawanKumar35438" style="color:#00aced;">paypal.me/PawanKumar35438</a></p>
    <p class="currency-note">For 1 Month: $5.99 USD | For 3 Months: $14.99 USD</p>
  </div>

  <!-- Main Payment Submission Form (for screenshot uploads) -->
  <form id="paymentForm" class="submit-form" action="https://luxflixbotv3.vercel.app/api/webhook" method="POST" enctype="multipart/form-data">
    <label for="userNameField">Your Name (as on VibeXXX)</label>
    <input type="text" name="name" id="userNameField" readonly /> 

    <input type="hidden" name="user_firebase_uid" id="userFirebaseUID" /> 
    <input type="hidden" name="user_email" id="userEmail" /> 
    <input type="hidden" name="membership_plan" id="selectedMembershipPlan" /> 
    <input type="hidden" name="payment_method" id="selectedPaymentMethod" /> 
    <input type="hidden" name="selected_price" id="selectedPrice" /> 
    <input type="hidden" name="selected_currency" id="selectedCurrency" /> 


    <label for="refID">UPI Ref ID or PayPal Email / Transaction ID</label>
    <input type="text" name="refID" id="refID" pattern="[a-zA-Z0-9@._-]+" required /> 
    <div class="hint">Enter your 12-digit UPI Reference ID (from Google Pay, PhonePe etc.) or PayPal email/transaction ID.</div>

    <label for="screenshot">Upload Payment Screenshot</label>
    <input type="file" name="screenshot" id="screenshot" accept="image/*" required />

    <button type="submit" class="submit-btn" id="submitBtn">ðŸ“¤ Submit Proof</button>
  </form>

  <!-- Thank You Message -->
  <div class="thankyou" id="thankyouMsg">
    âœ… Thank you! Your proof is submitted.<br/>Youâ€™ll be upgraded to Pro soon.
  </div>

  <hr>

  <script>
    // Include Firebase SDKs
    const firebaseAppScript = document.createElement('script');
    firebaseAppScript.src = "https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js";
    document.head.appendChild(firebaseAppScript);

    const firebaseAuthScript = document.createElement('script');
    firebaseAuthScript.src = "https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js";
    document.head.appendChild(firebaseAuthScript);

    // Wait for Firebase SDKs to load before initializing
    Promise.all([
        new Promise(resolve => firebaseAppScript.onload = resolve),
        new Promise(resolve => firebaseAuthScript.onload = resolve)
    ]).then(() => {
        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCc9N4rRu5-pjvOPDq78FUzQ2Bh2fuHyQ8",
            authDomain: "vibexxx-500c6.firebaseapp.com",
            projectId: "vibexxx-500c6",
            storageBucket: "vibexxx-500c6.firebasestorage.app",
            messagingSenderId: "880697212397",
            appId: "1:880697212397:web:b47c4b1d1dadcb6e5bbbe4"
        };

        // Initialize Firebase if not already initialized
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }
        // Initialize Firebase Authentication
        const auth = firebase.auth();

        // All other JavaScript code for the page
        let selectedPlan = '';
        let selectedMethod = '';
        let selectedPrice = '';
        let selectedCurrency = '';

        const membershipButtons = document.querySelectorAll('.membership-btn');
        const paymentMethodButtons = document.querySelectorAll('.button-group button');
        const paymentForm = document.getElementById('paymentForm');
        const upiSection = document.getElementById('upi');
        const paypalSection = document.getElementById('paypal');
        const thankYouMsg = document.getElementById('thankyouMsg');
        const submitBtn = document.getElementById('submitBtn');
        const userFirebaseUIDField = document.getElementById('userFirebaseUID');
        const userEmailField = document.getElementById('userEmail');
        const userNameField = document.getElementById('userNameField');
        const selectedMembershipPlanField = document.getElementById('selectedMembershipPlan');
        const selectedPaymentMethodField = document.getElementById('selectedPaymentMethod');
        const selectedPriceField = document.getElementById('selectedPrice');
        const selectedCurrencyField = document.getElementById('selectedCurrency');


        // Function to show/hide QR sections and main form
        function showPaymentSection() {
            // Ensure all dynamic sections are hidden first
            upiSection.style.display = 'none';
            paypalSection.style.display = 'none';
            paymentForm.style.display = 'none';
            thankYouMsg.style.display = 'none';

            if (selectedPlan && selectedMethod) {
                if (selectedMethod === 'upi') {
                    upiSection.style.display = 'block';
                    selectedCurrency = 'INR';
                } else if (selectedMethod === 'paypal') {
                    paypalSection.style.display = 'block';
                    selectedCurrency = 'USD';
                }
                selectedCurrencyField.value = selectedCurrency;

                const currentPlanButton = document.querySelector(`.membership-btn[data-plan="${selectedPlan}"]`);
                if (currentPlanButton) {
                    if (selectedCurrency === 'INR') {
                        selectedPrice = currentPlanButton.dataset.priceInr;
                    } else if (selectedCurrency === 'USD') {
                        selectedPrice = currentPlanButton.dataset.priceUsd;
                    }
                    selectedPriceField.value = selectedPrice;
                }

                paymentForm.style.display = 'block';
            }
        }

        // Event listeners for Membership Plan buttons
        membershipButtons.forEach(button => {
            button.addEventListener('click', () => {
                membershipButtons.forEach(btn => btn.classList.remove('active')); // Deactivate all
                button.classList.add('active'); // Activate clicked
                selectedPlan = button.dataset.plan;
                selectedMembershipPlanField.value = selectedPlan;
                showPaymentSection();
            });
        });

        // Event listeners for Payment Method buttons
        paymentMethodButtons.forEach(button => {
            button.addEventListener('click', () => {
                paymentMethodButtons.forEach(btn => btn.classList.remove('active')); // Optional: remove active class
                button.classList.add('active'); // Optional: add active class
                selectedMethod = button.dataset.method;
                selectedPaymentMethodField.value = selectedMethod;
                showPaymentSection();
            });
        });

        // Handle form submission for paymentForm
        paymentForm.addEventListener('submit', async function(e) {
            e.preventDefault();

            const user = firebase.auth().currentUser;

            if (!user) {
                alert('You must be logged in to submit payment proof.');
                return;
            }

            userFirebaseUIDField.value = user.uid;
            userEmailField.value = user.email || ''; 
            userNameField.value = user.displayName || user.email || user.uid; 
            
            if (!selectedPlan || !selectedMethod) {
                alert('Please select a membership plan and a payment method first.');
                return;
            }

            submitBtn.innerText = "â³ Submitting...";
            submitBtn.disabled = true;

            const formData = new FormData(paymentForm);

            try {
                const response = await fetch(paymentForm.action, {
                    method: 'POST',
                    body: formData
                });

                if (response.ok) {
                    paymentForm.style.display = 'none';
                    upiSection.style.display = 'none';
                    paypalSection.style.display = 'none';
                    thankYouMsg.style.display = 'block';
                } else {
                    const errorText = await response.text();
                    console.error("Submission failed:", response.status, errorText);
                    alert("âŒ Submission failed. Please try again. Error: " + (errorText || "Unknown"));
                }
            } catch (err) {
                console.error("Network error submitting form:", err);
                alert("âŒ Network error. Please check your internet and try again.");
            } finally {
                submitBtn.innerText = "ðŸ“¤ Submit Proof";
                submitBtn.disabled = false;
            }
        });

        // Important: Listen for Firebase auth state changes to ensure user is logged in
        auth.onAuthStateChanged(user => {
            if (user) {
                console.log("Firebase user is logged in:", user.uid, user.email);
                userFirebaseUIDField.value = user.uid;
                userEmailField.value = user.email || '';
                userNameField.value = user.displayName || user.email || `User ${user.uid.substring(0, 8)}...`;
                userNameField.readOnly = true; 

                paymentForm.style.pointerEvents = 'auto'; 
                paymentForm.style.opacity = '1';

            } else {
                console.log("No Firebase user logged in.");
                alert("Please log in to submit your membership payment proof.");
                paymentForm.style.pointerEvents = 'none'; 
                paymentForm.style.opacity = '0.5';
            }
        });

        // Initial state: hide forms until selections are made
        paymentForm.style.display = 'none';
        upiSection.style.display = 'none'; /* Ensure QR sections are hidden on load */
        paypalSection.style.display = 'none'; /* Ensure QR sections are hidden on load */
        thankYouMsg.style.display = 'none'; /* Ensure thank you message is hidden on load */
    }); // Close of Promise.all .then()
  </script>
</body>
</html>