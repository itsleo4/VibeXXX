<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>VibeXXX Pro Membership</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            inter: ['Inter', 'sans-serif'],
          },
          colors: {
            'dark-bg': '#0f0f0f',
            'card-bg': '#1c1c1c',
            'input-bg': '#2d2d2d',
            'pink-main': '#ff3366',
            'pink-light': '#ff1493',
            'pink-dark': '#ff416c',
            'green-upi': '#4caf50',
            'blue-paypal': '#0070ba',
            'success-green': '#00ff99',
          }
        }
      }
    }
  </script>
</head>
<body class="bg-dark-bg font-inter text-white flex flex-col items-center justify-center min-h-screen p-4">

  <h1 class="text-4xl md:text-5xl font-bold text-pink-main mb-4 drop-shadow-lg">
    💎 Become a Pro Member
  </h1>
  <p class="text-lg md:text-xl text-gray-300 mb-8">
    Choose your membership plan and payment method
  </p>

  <!-- Membership Plan Selection -->
  <div class="flex flex-wrap justify-center gap-4 mb-10 w-full max-w-2xl">
    <button class="membership-btn bg-gray-700 text-white border-2 border-gray-600 rounded-xl px-6 py-4 text-lg font-semibold flex-grow min-w-[180px] shadow-lg transition-all duration-300 ease-in-out hover:bg-gray-800 hover:border-pink-main hover:translate-y-[-3px] hover:shadow-xl" data-plan="1_MONTH" data-price-inr="249" data-price-usd="5.99">
        1 Month Membership
        <div class="text-success-green font-bold text-xl mt-2">₹249 / $5.99</div>
    </button>
    <button class="membership-btn bg-gray-700 text-white border-2 border-gray-600 rounded-xl px-6 py-4 text-lg font-semibold flex-grow min-w-[180px] shadow-lg transition-all duration-300 ease-in-out hover:bg-gray-800 hover:border-pink-main hover:translate-y-[-3px] hover:shadow-xl" data-plan="3_MONTH" data-price-inr="599" data-price-usd="14.99">
        3 Month Membership
        <div class="text-success-green font-bold text-xl mt-2">₹599 / $14.99</div>
    </button>
  </div>

  <div class="flex flex-wrap justify-center gap-4 mb-10 w-full max-w-2xl">
    <button class="upi-btn bg-green-upi text-white rounded-xl px-8 py-4 text-lg font-semibold flex-grow min-w-[180px] shadow-lg transition-all duration-300 ease-in-out hover:bg-green-600 hover:translate-y-[-3px] hover:shadow-xl" data-method="upi">Pay with UPI</button>
    <button class="paypal-btn bg-blue-paypal text-white rounded-xl px-8 py-4 text-lg font-semibold flex-grow min-w-[180px] shadow-lg transition-all duration-300 ease-in-out hover:bg-blue-600 hover:translate-y-[-3px] hover:shadow-xl" data-method="paypal">Pay with PayPal</button>
  </div>

  <!-- UPI QR Section -->
  <div id="upi" class="qr-section bg-card-bg p-6 rounded-2xl shadow-2xl w-11/12 max-w-md mx-auto mb-8 hidden">
    <img src="https://raw.githubusercontent.com/itsleo4/VibeXXX/main/images/upi.png" alt="UPI QR" class="max-w-[70%] h-auto mx-auto mb-6 rounded-lg border-4 border-pink-main p-1 bg-white">
    <p class="text-lg text-gray-200 mb-2"><strong>Pay to:</strong> bharti00077-2@okaxis</p>
    <p class="text-sm text-gray-400 mt-1">For 1 Month: ₹249 | For 3 Months: ₹599</p>
  </div>

  <!-- PayPal QR Section -->
  <div id="paypal" class="qr-section bg-card-bg p-6 rounded-2xl shadow-2xl w-11/12 max-w-md mx-auto mb-8 hidden">
    <img src="https://raw.githubusercontent.com/itsleo4/VibeXXX/main/images/paypal.png" alt="PayPal QR" class="max-w-[70%] h-auto mx-auto mb-6 rounded-lg border-4 border-pink-main p-1 bg-white">
    <p class="text-lg text-gray-200 mb-2"><strong>PayPal:</strong> <a href="https://www.paypal.me/PawanKumar35438" class="text-blue-400 hover:underline font-semibold">paypal.me/PawanKumar35438</a></p>
    <p class="text-sm text-gray-400 mt-1">For 1 Month: $5.99 USD | For 3 Months: $14.99 USD</p>
  </div>

  <!-- Main Payment Submission Form -->
  <form id="paymentForm" class="submit-form bg-card-bg p-6 rounded-2xl shadow-2xl w-11/12 max-w-md mx-auto mb-8 hidden">
    <label for="userNameField" class="block text-left text-gray-300 text-sm font-medium mb-1">Your Name (as on VibeXXX)</label>
    <input type="text" name="name" id="userNameField" readonly class="w-full p-3 mb-4 rounded-lg bg-input-bg text-white border border-gray-600 focus:outline-none focus:border-pink-main focus:ring-1 focus:ring-pink-main" /> 

    <input type="hidden" name="user_firebase_uid" id="userFirebaseUID" /> 
    <input type="hidden" name="user_email" id="userEmail" /> 
    <input type="hidden" name="membership_plan" id="selectedMembershipPlan" /> 
    <input type="hidden" name="payment_method" id="selectedPaymentMethod" /> 
    <input type="hidden" name="selected_price" id="selectedPrice" /> 
    <input type="hidden" name="selected_currency" id="selectedCurrency" /> 

    <label for="refID" class="block text-left text-gray-300 text-sm font-medium mb-1">UPI Ref ID or PayPal Email / Transaction ID</label>
    <input type="text" name="refID" id="refID" pattern="[a-zA-Z0-9@._-]+" required class="w-full p-3 mb-2 rounded-lg bg-input-bg text-white border border-gray-600 focus:outline-none focus:border-pink-main focus:ring-1 focus:ring-pink-main" />
    <div class="text-xs text-gray-400 text-left mb-4">Enter your 12-digit UPI Reference ID (from Google Pay, PhonePe etc.) or PayPal email/transaction ID.</div>

    <label for="screenshot" class="block text-left text-gray-300 text-sm font-medium mb-2">Upload Payment Screenshot</label>
    <input type="file" name="screenshot" id="screenshot" accept="image/*" required class="w-full p-3 mb-6 rounded-lg bg-input-bg text-white border border-gray-600 focus:outline-none focus:border-pink-main focus:ring-1 focus:ring-pink-main file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-pink-light file:text-white hover:file:bg-pink-dark hover:file:cursor-pointer transition-all duration-300" />

    <button type="submit" class="submit-btn bg-gradient-to-r from-pink-light to-pink-dark text-white font-bold text-xl px-10 py-4 rounded-xl shadow-lg transition-all duration-300 ease-in-out hover:from-pink-dark hover:to-pink-light hover:translate-y-[-3px] hover:shadow-xl" id="submitBtn">
      📤 Submit Proof
    </button>
  </form>

  <!-- Thank You Message -->
  <div class="thankyou bg-card-bg p-6 rounded-2xl shadow-2xl w-11/12 max-w-md mx-auto mb-8 hidden">
    <p class="text-success-green text-2xl font-semibold">✅ Thank you! Your proof is submitted.</p>
    <p class="text-gray-300 text-lg mt-2">You’ll be upgraded to Pro soon.</p>
  </div>

  <hr class="border-t-2 border-pink-main w-3/5 my-12 opacity-70">

  <script>
    // Include Firebase SDKs
    const firebaseAppScript = document.createElement('script');
    firebaseAppScript.src = "https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js";
    document.head.appendChild(firebaseAppScript);

    const firebaseAuthScript = document.createElement('script');
    firebaseAuthScript.src = "https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js";
    document.head.appendChild(firebaseAuthScript);

    // Wait for Firebase SDKs to load before initializing
    Promise.all([
        new Promise(resolve => firebaseAppScript.onload = resolve),
        new Promise(resolve => firebaseAuthScript.onload = resolve)
    ]).then(() => {
        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCc9N4rRu5-pjvOPDq78FUzQ2Bh2fuHyQ8",
            authDomain: "vibexxx-500c6.firebaseapp.com",
            projectId: "vibexxx-500c6",
            storageBucket: "vibexxx-500c6.firebasestorage.app",
            messagingSenderId: "880697212397",
            appId: "1:880697212397:web:b47c4b1d1dadcb6e5bbbe4"
        };

        // Initialize Firebase if not already initialized
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }
        // Initialize Firebase Authentication
        const auth = firebase.auth();

        // All other JavaScript code for the page
        let selectedPlan = '';
        let selectedMethod = '';
        let selectedPrice = '';
        let selectedCurrency = '';

        const membershipButtons = document.querySelectorAll('.membership-btn');
        const paymentMethodButtons = document.querySelectorAll('.button-group button');
        const paymentForm = document.getElementById('paymentForm');
        const upiSection = document.getElementById('upi');
        const paypalSection = document.getElementById('paypal');
        const thankYouMsg = document.getElementById('thankyouMsg');
        const submitBtn = document.getElementById('submitBtn');
        const userFirebaseUIDField = document.getElementById('userFirebaseUID');
        const userEmailField = document.getElementById('userEmail');
        const userNameField = document.getElementById('userNameField');
        const selectedMembershipPlanField = document.getElementById('selectedMembershipPlan');
        const selectedPaymentMethodField = document.getElementById('selectedPaymentMethod');
        const selectedPriceField = document.getElementById('selectedPrice');
        const selectedCurrencyField = document.getElementById('selectedCurrency');


        // Function to show/hide QR sections and main form
        function showPaymentSection() {
            // Hide all payment sections and form initially
            upiSection.classList.add('hidden');
            paypalSection.classList.add('hidden');
            paymentForm.classList.add('hidden');
            thankYouMsg.classList.add('hidden');

            if (selectedPlan && selectedMethod) {
                if (selectedMethod === 'upi') {
                    upiSection.classList.remove('hidden');
                    selectedCurrency = 'INR';
                } else if (selectedMethod === 'paypal') {
                    paypalSection.classList.remove('hidden');
                    selectedCurrency = 'USD';
                }
                selectedCurrencyField.value = selectedCurrency;

                const currentPlanButton = document.querySelector(`.membership-btn[data-plan="${selectedPlan}"]`);
                if (currentPlanButton) {
                    if (selectedCurrency === 'INR') {
                        selectedPrice = currentPlanButton.dataset.priceInr;
                    } else if (selectedCurrency === 'USD') {
                        selectedPrice = currentPlanButton.dataset.priceUsd;
                    }
                    selectedPriceField.value = selectedPrice;
                }

                paymentForm.classList.remove('hidden');
            }
        }

        // Event listeners for Membership Plan buttons
        membershipButtons.forEach(button => {
            button.addEventListener('click', () => {
                // Remove active styling from all membership buttons
                membershipButtons.forEach(btn => {
                    btn.classList.remove('bg-pink-main', 'border-pink-main', 'shadow-2xl');
                    btn.classList.add('bg-gray-700', 'border-gray-600', 'shadow-lg');
                });
                // Add active styling to the clicked button
                button.classList.add('bg-pink-main', 'border-pink-main', 'shadow-2xl');
                button.classList.remove('bg-gray-700', 'border-gray-600', 'shadow-lg');

                selectedPlan = button.dataset.plan;
                selectedMembershipPlanField.value = selectedPlan;
                showPaymentSection();
            });
        });

        // Event listeners for Payment Method buttons
        paymentMethodButtons.forEach(button => {
            button.addEventListener('click', () => {
                // Remove active styling from all payment method buttons
                paymentMethodButtons.forEach(btn => {
                    if (btn.dataset.method === 'upi') {
                        btn.classList.remove('bg-green-600', 'shadow-xl');
                        btn.classList.add('bg-green-upi', 'shadow-lg');
                    } else if (btn.dataset.method === 'paypal') {
                        btn.classList.remove('bg-blue-600', 'shadow-xl');
                        btn.classList.add('bg-blue-paypal', 'shadow-lg');
                    }
                });
                // Add active styling to the clicked button
                if (button.dataset.method === 'upi') {
                    button.classList.remove('bg-green-upi', 'shadow-lg');
                    button.classList.add('bg-green-600', 'shadow-xl');
                } else if (button.dataset.method === 'paypal') {
                    button.classList.remove('bg-blue-paypal', 'shadow-lg');
                    button.classList.add('bg-blue-600', 'shadow-xl');
                }

                selectedMethod = button.dataset.method;
                selectedPaymentMethodField.value = selectedMethod;
                showPaymentSection();
            });
        });

        // Handle form submission for paymentForm
        paymentForm.addEventListener('submit', async function(e) {
            e.preventDefault();

            const user = firebase.auth().currentUser;

            if (!user) {
                alert('You must be logged in to submit payment proof.');
                return;
            }

            userFirebaseUIDField.value = user.uid;
            userEmailField.value = user.email || ''; 
            userNameField.value = user.displayName || user.email || user.uid; 
            
            if (!selectedPlan || !selectedMethod) {
                alert('Please select a membership plan and a payment method first.');
                return;
            }

            submitBtn.innerText = "⏳ Submitting...";
            submitBtn.disabled = true;

            const formData = new FormData(paymentForm);

            try {
                const response = await fetch(paymentForm.action, {
                    method: 'POST',
                    body: formData
                });

                if (response.ok) {
                    paymentForm.classList.add('hidden');
                    upiSection.classList.add('hidden');
                    paypalSection.classList.add('hidden');
                    thankYouMsg.classList.remove('hidden');
                } else {
                    const errorText = await response.text();
                    console.error("Submission failed:", response.status, errorText);
                    alert("❌ Submission failed. Please try again. Error: " + (errorText || "Unknown"));
                }
            } catch (err) {
                console.error("Network error submitting form:", err);
                alert("❌ Network error. Please check your internet and try again.");
            } finally {
                submitBtn.innerText = "📤 Submit Proof";
                submitBtn.disabled = false;
            }
        });

        // Important: Listen for Firebase auth state changes to ensure user is logged in
        auth.onAuthStateChanged(user => {
            if (user) {
                console.log("Firebase user is logged in:", user.uid, user.email);
                userFirebaseUIDField.value = user.uid;
                userEmailField.value = user.email || '';
                userNameField.value = user.displayName || user.email || `User ${user.uid.substring(0, 8)}...`;
                userNameField.readOnly = true; 

                paymentForm.classList.remove('pointer-events-none', 'opacity-50');
                paymentForm.classList.add('pointer-events-auto', 'opacity-100');

            } else {
                console.log("No Firebase user logged in.");
                alert("Please log in to submit your membership payment proof.");
                paymentForm.classList.add('pointer-events-none', 'opacity-50');
                paymentForm.classList.remove('pointer-events-auto', 'opacity-100');
            }
        });

        // Initial state: hide all dynamic sections
        upiSection.classList.add('hidden');
        paypalSection.classList.add('hidden');
        paymentForm.classList.add('hidden');
        thankYouMsg.classList.add('hidden');
    }); // Close of Promise.all .then()
  </script>
</body>
</html>